# SmartSeating

SmartSeating 是一个基于 .NET 10 / WPF 的智能座位管理工具，旨在帮助教师或培训组织快速构建、调整和导出课堂座位图。项目内置 Excel 名单导入、JSON 配置保存、多条件智能排座、图片/表格导出等能力，适合用于教室、考场、活动等需要频繁调座的场景。

## 功能亮点
- ✅ **所见即所得的座位画布**：支持拖拽框选、右键菜单、快捷键（F 固定、D 禁用、Delete 清空）等交互。
- ✅ **智能排座**：使用模拟退火算法综合考虑身高、重要程度、靠近/远离同学、偏好区域等维度，自动寻找更优布局。
- ✅ **名单管理增强**：左侧名单支持关键字实时筛选、统计总人数/已入座/待安排人数，点击即可定位学生座位。
- ✅ **导入导出**：支持 Excel 名单导入、JSON 配置读写、导出座位 Excel 或 PNG 图片备份/分享。
- ✅ **自动保存**：退出时自动保存最近一次配置，下一次启动可无感恢复。

## 环境要求
- Windows 10/11
- [.NET SDK 10.0 (含 WPF)](https://dotnet.microsoft.com/) 及以上版本
- 若需 Excel 导入/导出，请安装 `ClosedXML` 依赖（已通过 NuGet 引入）

## 快速开始
```bash
# 恢复依赖并编译
 dotnet restore
 dotnet build SmartSeating/SmartSeating.csproj -c Release

# 运行（调试）
 dotnet run --project SmartSeating/SmartSeating.csproj
```

## 主要界面说明
- **顶部工具条**：设置行列数、一键放置、智能排座，以及 Excel/JSON/图片导入导出。
- **左侧名单**：展示所有学生。可以通过搜索框过滤，底部实时统计总人数、已入座和待安排数量。选择任意学生会自动高亮并滚动到其座位。
- **中间画布**：可视化座位网格，鼠标悬停/选中有不同描边，图例展示普通/固定/禁用三种状态。
- **右侧详情**：显示当前选中座位信息，可编辑学生属性、固定/禁用状态、偏好/限制等，保存后即时生效。

## 常用操作流程
1. **导入名单**：点击“导入 Excel (名单)”，选择包含姓名列的工作簿；系统会清空当前配置并自动放置学生。
2. **手动微调**：
   - 鼠标点击/框选座位，右侧面板可编辑属性。
   - 使用快捷键 F 切换固定、D 切换禁用、Delete 清空座位。
   - 通过左侧搜索快速定位学生。
3. **智能排座**：点击“智能排座”，程序会结合学生权重与限制自动优化非固定座位，进度条实时反馈。
4. **导出成果**：根据需要导出 JSON、Excel 或 PNG，方便分享或备份。

## 配置文件
应用会在根目录生成 `SeatingConfig.json`，内容包含：
- 座位行列数
- 所有学生的权重/偏好
- 每个座位的固定/禁用状态及学生分配

可通过“导入/导出配置”按钮进行跨机器同步或版本管理。

## 贡献
欢迎提交 Issue/PR 帮助改进项目，或根据需要 Fork 后自定义。若在使用过程中遇到问题，也欢迎反馈。
